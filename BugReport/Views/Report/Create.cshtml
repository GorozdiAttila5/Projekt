@using BugReport.Models.Report;
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer localizer
@model CreateReportViewModel;
@{
    ViewData["Title"] = localizer["new-report"];
}

<div class="main-card">
    <h2 class="title-text text-center">@localizer["new-report"]</h2>
    <form asp-controller="Report" asp-action="Create" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <div class="mb-3">
            <label asp-for="Title" class="form-label fw-bold"></label>
            <input asp-for="Title" class="form-control" />
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Assignees" class="form-label fw-bold"></label>
            <div class="assignee-selector dropdown">
                <div id="assignee-tag-container" class="form-control d-flex flex-wrap
            align-items-center gap-2 position-relative" style="min-height: 42px; cursor: text" data-placeholder="@localizer["add-assignees-placeholder"]">
                    <input id="assignee-input" class="border-0 flex-grow-2" type="text"
                           placeholder="@localizer["add-assignees-placeholder"]" autocomplete="off" />
                </div>

                <div id="assignee-dropdown" class="dropdown-menu w-100 mt-1"></div>

                <div id="assignee-hidden"></div>
            </div>
            <span asp-validation-for="Assignees" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Description" class="form-label fw-bold"></label>
            <textarea asp-for="Description" class="form-control" rows="7" style="resize:none"></textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Attachments" class="form-label fw-bold"></label>
            <div id="file-dropzone" class="drop-zone border rounded bg-white p-4 text-center">
                <p class="text-muted">@localizer["drag-and-drop"]</p>
                <input asp-for="Attachments" type="file" id="file-input" class="d-none" multiple />
            </div>
            <div id="file-preview" class="mt-3 d-flex flex-wrap gap-3"></div>
            <span asp-validation-for="Attachments" class="text-danger"></span>
        </div>
        <input type="submit" value="@localizer["create"]" class="btn btn-dark-blue w-100 p-2"/>
        <a asp-controller="Report" asp-action="Index" class="btn btn-outline-dark-blue w-100 p-2 mt-3">@localizer["cancel"]</a>
    </form>
</div>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial.cshtml");
    }
    <script src="~/js/create-report.js"></script>
}
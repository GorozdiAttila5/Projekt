@using BugReport.Models.Report;
@model CreateReportViewModel;
@{
    ViewData["Title"] = "New report";
}

<div class="main-card">
    <h2 class="title-text text-center">New report</h2>
    <form asp-controller="Report" asp-action="Create" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <div class="mb-3">
            <label asp-for="Title" class="form-label fw-bold"></label>
            <input asp-for="Title" class="form-control" />
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Assignees" class="form-label fw-bold"></label>
            <div class="assignee-selector dropdown">
                <div id="assignee-tag-container" class="form-control d-flex flex-wrap
            align-items-center gap-2 position-relative" style="min-height: 42px; cursor: text">
                    <input id="assignee-input" class="border-0 flex-grow-2" type="text"
                           placeholder="Add assignees..." autocomplete="off" />
                </div>

                <!-- Bootstrap-compatible dropdown -->
                <div id="assignee-dropdown" class="dropdown-menu w-100 mt-1"></div>

                <div id="assignee-hidden"></div>
            </div>
            <span asp-validation-for="Assignees" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Description" class="form-label fw-bold"></label>
            <textarea asp-for="Description" class="form-control" rows="7" style="resize:none"></textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Attachments" class="form-label fw-bold"></label>
            <div id="file-dropzone" class="drop-zone border rounded bg-white p-4 text-center">
                <p class="text-muted">Drag and drop images here or click to browse</p>
                <input asp-for="Attachments" type="file" accept="image/*" id="file-input" class="d-none" multiple />
            </div>
            <div id="file-preview" class="mt-3 d-flex flex-wrap gap-3"></div>
            <span asp-validation-for="Attachments" class="text-danger"></span>
        </div>
        <input type="submit" value="Create" class="btn btn-dark-blue w-100 p-2"/>
        <a asp-controller="Report" asp-action="Index" class="btn btn-outline-dark-blue w-100 p-2 mt-3">Cancel</a>
    </form>
</div>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial.cshtml");
    }
    <script src="~/js/report.js"></script>
}